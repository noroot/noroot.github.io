<!DOCTYPE html>
<html lang="en">
    <head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon">
	<link rel="stylesheet" href="/blogassets/main.css">
	<link rel="stylesheet" href="/blogassets/highlight.css">
	<title>Go за 20 часов | False!True</title>
        
        
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28956735-2"></script>
	<script>
	 window.dataLayer = window.dataLayer || [];
	 function gtag(){dataLayer.push(arguments);}
	 gtag('js', new Date());

	 gtag('config', 'UA-28956735-2');
	</script>
    </head>
    <body>
	<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top mb-5">
	    <div class="container">
		<a class="navbar-brand" href="/"><span style="color:lightgreen"> False!</span><span style="color:cyan">True</span></a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsEx" aria-controls="navbarsEx" aria-expanded="false" aria-label="Toggle navigation">
		    <span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarsEx">
		    <ul class="navbar-nav mr-auto">
			<li class="nav-item active">
			    <a class="nav-link" href="#">Home</a>
			</li>
			<li class="nav-item">
			    <a class="nav-link" href="/archive/">Archive</a>
			</li>
			<li class="nav-item">
			    <a class="nav-link" href="/categories/books/">Bookshelf</a>
			</li>
			<li class="nav-item">
			    <a class="nav-link" href="https://slides.falsetrue.io">Slides</a>
			</li>
			<li class="nav-item">
			    <a class="nav-link" href="/about/">About</a>
			</li>
		    </ul>
		    <ul class="nav navbar-nav navbar-right">
			<li>
		            <a href="/bloghttp://feeds.feedburner.com/OvermindsHive" class="om-rss-link">Subscirbe <img src="/images/rss.png" /> RSS</a>
			</li>
                    </ul>
		</div>
	    </div>
	</nav>
	
	<div class="container mt-3 pt-5">
            <div class="row mb-5" style="border-left: 4px solid lightgray">
    <div class="col">
	<time datetime="2016-03-15 00:59:00 +0300">March 15, 2016</time>    
	<h1>Go за 20 часов</h1>
	<p class="meta">
	    
	</p>
	<div class="post-categories pb-3">
	    Categories:
	    
	    <a href="/categories/dev/" class="badge badge-success">dev</a>
	    
	</div>
	<div class="content">
	    <p>Решил потратить выходные с пользой, и вернутся к изучению Go. У меня
было примерно 20 часов, за которые я успел изучить все что мне нужно и
написал довольно простой mvc-like фреймворк. Начем по порядоку.</p>

<p>До этого момента я пробовал Go около 3х лет назад, непомню какая
была версия, но помню о Go тогда только начали узнавать. О самом языке
тогда небыло ничего ясно кроме того что он от Google. И что многие
известные люди успешно разрабатывают на Go например
<a href="https://github.com/bradfitz">Brad Fitzpatrik</a></p>

<p>Непросто так упоминаю Бреда Фитцпатрика, а потому что первое
приложение на Go в исходники которого я смотрел был
<a href="https://camlistore.org/">Camilstore</a> - персональное хранилище с
синхронзацией. На тот момент это казалось непостижимо сложными и
трудно изучаемым, прошло время и про Go стали говорить больше и не
только в “долине”.</p>

<p>До этого я много писал на ruby и javascript, и php и python, потому для
меня интересно как Go будет решать те задачи которые уже можно было
решать с помошью известных мне инструментов и как создавать на
нем то для чего сам язык и предназначался.</p>

<p>Вопросы которые для меня важны когда я изучаю новый ЯП</p>

<ul>
  <li>Документация</li>
  <li>Наличие готовых библиотек и рабочих проудктов</li>
  <li>Наличие комьюнити</li>
  <li>Наличие качественной библиотеки для работы с БД</li>
  <li>Быстрое понимание</li>
  <li>Приятный синтаксис</li>
</ul>

<p>Примерно через 20 часов я получил положительные ответы на свои вопросы</p>

<h3 id="что-такое-язык-go-">Что такое язык Go ?</h3>

<p>Это компилируемый язык со статической типизацией, предназначенный для
реализации высокопроизводительных паралельных вычислений, в нем есть
garbage collector, memory safety - безопасный доступ к памяти, а также CSP
который как раз используется для описания паралельных вычислейний.
Go похож на C но с улучшениями в сторону понимания, простоты и
безопасности.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="s">"fmt"</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"hello world"</span><span class="p">)</span><span class="x">
</span><span class="p">}</span></code></pre></figure>

<p>Вконце будут ссылки по которым можно понятно и подробно прочитать про
Go.</p>

<p>А ниже немного интересных моментов языка.</p>

<!-- more -->

<h3 id="неопределенное-количество-аргументов">Неопределенное количество аргументов</h3>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">func</span><span class="x"> </span><span class="n">Nice</span><span class="p">(</span><span class="n">first</span><span class="x"> </span><span class="kt">string</span><span class="p">,</span><span class="x"> </span><span class="n">shits</span><span class="x"> </span><span class="o">...</span><span class="kt">string</span><span class="p">)</span><span class="x"> </span><span class="kt">int64</span><span class="x"> </span><span class="p">{</span><span class="x">
    
</span><span class="p">}</span></code></pre></figure>

<h3 id="struct--структуры">Struct / Структуры</h3>
<p>Структура это набор поименовынх элементов определенного типа.
Структуры можно наследовать, а точнее включать одну или несколько в другую.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="c">// A struct with 6 fields.</span><span class="x">
</span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="kt">int</span><span class="x">
	</span><span class="n">u</span><span class="x"> </span><span class="kt">float32</span><span class="x">
	</span><span class="n">_</span><span class="x"> </span><span class="kt">float32</span><span class="x"> 
	</span><span class="n">A</span><span class="x"> </span><span class="o">*</span><span class="p">[]</span><span class="kt">int</span><span class="x">
	</span><span class="n">F</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x">
</span><span class="p">}</span></code></pre></figure>

<p>Пример встаривания структур</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">type</span><span class="x"> </span><span class="n">Animal</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="n">Name</span><span class="x"> </span><span class="kt">string</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">type</span><span class="x"> </span><span class="n">Cat</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="n">Animal</span><span class="x">
    </span><span class="n">Breed</span><span class="x"> </span><span class="kt">string</span><span class="x">
</span><span class="p">}</span><span class="x">
    </span></code></pre></figure>

<p>Структура также может быть определена с использованием тега
<a href="https://golang.org/ref/spec#Struct_types">Подбронее</a></p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">camelCaseString</span><span class="x">  </span><span class="kt">uint64</span><span class="x"> </span><span class="s">`json:"came_case_string"`</span><span class="x">
	</span><span class="n">serverIP6</span><span class="x"> </span><span class="kt">uint64</span><span class="x"> </span><span class="s">`json:"server_ip6"`</span><span class="x">
</span><span class="p">}</span></code></pre></figure>

<p>Тег используется во вспомогательных целях, в данном примере он
указывает на то что в случае представляени структуры в виде json,
названия полей в структуре будет заменены на указанные в теге. Это
очень удобная нотация, ее используют многие другие пакеты на Go.</p>

<h3 id="interfaces--интерфейсы">Interfaces / Интерфейсы</h3>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">type</span><span class="x"> </span><span class="n">Shape</span><span class="x"> </span><span class="k">interface</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="n">area</span><span class="p">()</span><span class="x"> </span><span class="kt">float64</span><span class="x">
</span><span class="p">}</span><span class="x">
        </span></code></pre></figure>

<h3 id="channels--каналы">Channels / Каналы</h3>

<p>Канал предоставляет механизм конкуретного вызова функций. С помощью
его можно оргазовывать пайплайны (pipelines)</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">chan</span><span class="x"> </span><span class="n">T</span><span class="x">          </span><span class="c">// can be used to send and receive values of type T</span><span class="x">
</span><span class="k">chan</span><span class="o">&lt;-</span><span class="x"> </span><span class="kt">float64</span><span class="x">  </span><span class="c">// can only be used to send float64s</span><span class="x">
</span><span class="o">&lt;-</span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="x">      </span><span class="c">// can only be used to receive ints</span></code></pre></figure>

<p>Пример работы каналов (взял <a href="http://wysocki.in/golang-channels-basics/">отсюда</a>)</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="s">"fmt"</span><span class="x">
</span><span class="k">import</span><span class="x"> </span><span class="s">"time"</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">doIt</span><span class="p">(</span><span class="n">done</span><span class="x"> </span><span class="k">chan</span><span class="x"> </span><span class="kt">bool</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
    	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="s">"working..."</span><span class="p">)</span><span class="x">
    	</span><span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">)</span><span class="x">
    	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"done"</span><span class="p">)</span><span class="x">
	
        </span><span class="c">// send value to channel</span><span class="x">
    	</span><span class="n">done</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="no">true</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="c">// We're creating channel and</span><span class="x">
        </span><span class="c">// starting doIt function as gorouine</span><span class="x">
    	</span><span class="n">done</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="kt">bool</span><span class="p">)</span><span class="x">
    	</span><span class="k">go</span><span class="x"> </span><span class="n">doIt</span><span class="p">(</span><span class="n">done</span><span class="p">)</span><span class="x">

        </span><span class="c">// reading from channel with `&lt;-` blocks program until</span><span class="x">
        </span><span class="c">// we receive value after one second in `doIt` function</span><span class="x">
    	</span><span class="n">a</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&lt;-</span><span class="n">done</span><span class="x">
    	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="x">
    </span><span class="p">}</span></code></pre></figure>

<p>Это очень простой пример каналов, больше примеров ищите по ссылкам в
конце поста.</p>

<h3 id="goroutines">Goroutines</h3>

<p>Отложенные процедуры <a href="http://play.golang.org/p/RW_RSAHfj-">Пример</a></p>

<p>Отложенны процедуры или функции выполняются асинхронно независимо от
других частей программы.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="c">// A _goroutine_ is a lightweight thread of execution.</span><span class="x">

</span><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="s">"fmt"</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">f</span><span class="p">(</span><span class="n">from</span><span class="x"> </span><span class="kt">string</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="m">3</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="o">++</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">from</span><span class="p">,</span><span class="x"> </span><span class="s">":"</span><span class="p">,</span><span class="x"> </span><span class="n">i</span><span class="p">)</span><span class="x">
    </span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">

    </span><span class="c">// Suppose we have a function call `f(s)`. Here's how</span><span class="x">
    </span><span class="c">// we'd call that in the usual way, running it</span><span class="x">
    </span><span class="c">// synchronously.</span><span class="x">
    
    </span><span class="n">f</span><span class="p">(</span><span class="s">"direct"</span><span class="p">)</span><span class="x">

    </span><span class="c">// To invoke this function in a goroutine, use</span><span class="x">
    </span><span class="c">// `go f(s)`. This new goroutine will execute</span><span class="x">
    </span><span class="c">// concurrently with the calling one.</span><span class="x">
    
    </span><span class="k">go</span><span class="x"> </span><span class="n">f</span><span class="p">(</span><span class="s">"goroutine"</span><span class="p">)</span><span class="x">

    </span><span class="c">// You can also start a goroutine for an anonymous</span><span class="x">
    </span><span class="c">// function call.</span><span class="x">
    
    </span><span class="k">go</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">msg</span><span class="x"> </span><span class="kt">string</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="x">
    </span><span class="p">}(</span><span class="s">"going"</span><span class="p">)</span><span class="x">

    </span><span class="c">// Our two function calls are running asynchronously in</span><span class="x">
    </span><span class="c">// separate goroutines now, so execution falls through</span><span class="x">
    </span><span class="c">// to here. This `Scanln` code requires we press a key</span><span class="x">
    </span><span class="c">// before the program exits.</span><span class="x">
    
    </span><span class="k">var</span><span class="x"> </span><span class="n">input</span><span class="x"> </span><span class="kt">string</span><span class="x">
    </span><span class="n">fmt</span><span class="o">.</span><span class="n">Scanln</span><span class="p">(</span><span class="o">&amp;</span><span class="n">input</span><span class="p">)</span><span class="x">
    </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"done"</span><span class="p">)</span><span class="x">
</span><span class="p">}</span></code></pre></figure>

<p>Кроме goroutines в Go есть инструкция <strong>defer</strong> с помощью которой
можно выполнять функции в конце заверешния работы текущего scope
функции. <a href="https://tour.golang.org/flowcontrol/12">Пример работы defer</a></p>

<h3 id="тесты">Тесты</h3>
<p>Для тестирования в Go существует стандартная библиотека <strong>testing</strong></p>

<p>Простой пример с использованием стороннего пакета для assertion</p>

<p>Нужно обратит внимание что тесты в Go должны находится в файлах с
суффиксом test <strong>soulkitchen_test.go</strong> а методы внутри дожныы иметь
префикс Test</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span><span class="x"> </span><span class="n">soulkitchen</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="p">(</span><span class="x">

	</span><span class="s">"github.com/stretchr/testify/assert"</span><span class="x">
	</span><span class="s">"testing"</span><span class="x">
</span><span class="p">)</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">TestNew</span><span class="p">(</span><span class="n">t</span><span class="x"> </span><span class="o">*</span><span class="n">testing</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">

	</span><span class="n">assert</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">assert</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="x">
	</span><span class="n">assert</span><span class="o">.</span><span class="n">Nil</span><span class="p">(</span><span class="no">nil</span><span class="p">)</span><span class="x">
</span><span class="p">}</span></code></pre></figure>

<p>Нестал писать скольконибудь подробное тестирование, но простейший
пример привел. Запуск тестов в данном случае это выполнение в корне
проекта команды:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go test
</code></pre></div></div>

<p>которая запустит все тесты в текущей директрии</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go test
PASS
ok  	github.com/noroot/soulkitchen	0.014s
</code></pre></div></div>

<p><a href="https://golang.org/doc/code.html#Testing">Подробнее про тесты</a></p>

<p>Кроме тестов в Go существуют бенчмарки (Benchmarks) которые позволяют
понять насколько быстро работают написанные механизмы. Чтобы
воспользоваться бенчмарками нужно сделать особо обьявленный метод.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">func</span><span class="x"> </span><span class="n">BenchmarkHello</span><span class="p">(</span><span class="n">b</span><span class="x"> </span><span class="o">*</span><span class="n">testing</span><span class="o">.</span><span class="n">B</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="n">b</span><span class="o">.</span><span class="n">N</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="o">++</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"hello"</span><span class="p">)</span><span class="x">
    </span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">
    </span></code></pre></figure>

<p>Бенчмарки запускаются с помощью команды</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go test -bench .
</code></pre></div></div>

<p>В качестве параметра к ключу <strong>bench</strong> указывается регулярное
выражение маска для того чтобы определить какие бенчмарки запускать
Подробнее про возможные параметры запуска
<a href="https://golang.org/cmd/go/#hdr-Description_of_testing_flags">здесь</a></p>

<h3 id="coding-style">Coding style</h3>

<p>Для соблюдения конвенций по стилю форматирования файлов, в Go
предусмотрена специальная утилита <strong>gofmt</strong> которая форматирует
исходный код.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gofmt src/main.go
</code></pre></div></div>

<p>В Go для отступов принята табулция шириной 8.</p>

<h3 id="документация">Документация</h3>

<p>Утилита <strong>godoc</strong> которая идет в комплекте в месте языком умеет делать
очень полезнюу вешь, а именно серфить докумнетацию, причем локально.
Для это нужно запустить команду и открыть браузер</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>godoc -http=:6060
</code></pre></div></div>

<h3 id="пример">Пример</h3>

<p>Пример программы на Go в котором GET запросом получается контент
страницы. Примре избыточен в нем показано сразу несколько фич Go
(каналы, интерфейсы, замыкания, отложенные процедуры)</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">
</span><span class="k">import</span><span class="x"> </span><span class="p">(</span><span class="x">
	</span><span class="s">"io/ioutil"</span><span class="x">
	</span><span class="s">"log"</span><span class="x">
	</span><span class="s">"net/http"</span><span class="x">
</span><span class="p">)</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">Future</span><span class="p">(</span><span class="n">f</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">(</span><span class="k">interface</span><span class="p">{},</span><span class="x"> </span><span class="kt">error</span><span class="p">))</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">(</span><span class="k">interface</span><span class="p">{},</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">var</span><span class="x"> </span><span class="n">result</span><span class="x"> </span><span class="k">interface</span><span class="p">{}</span><span class="x">
    </span><span class="k">var</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="kt">error</span><span class="x">

    </span><span class="n">c</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="k">struct</span><span class="p">{},</span><span class="x"> </span><span class="m">1</span><span class="p">)</span><span class="x">
    </span><span class="k">go</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="k">defer</span><span class="x"> </span><span class="nb">close</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="x">
        </span><span class="n">result</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">f</span><span class="p">()</span><span class="x">
    </span><span class="p">}()</span><span class="x">

    </span><span class="k">return</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">(</span><span class="k">interface</span><span class="p">{},</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="o">&lt;-</span><span class="n">c</span><span class="x">
        </span><span class="k">return</span><span class="x"> </span><span class="n">result</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x">
    </span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">


</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	
	</span><span class="n">url</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="s">"http://labs.strava.com"</span><span class="x">
	</span><span class="n">future</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">Future</span><span class="p">(</span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">(</span><span class="k">interface</span><span class="p">{},</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="n">resp</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">http</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="x">
		</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="k">return</span><span class="x"> </span><span class="no">nil</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x">
		</span><span class="p">}</span><span class="x">
		</span><span class="k">defer</span><span class="x"> </span><span class="n">resp</span><span class="o">.</span><span class="n">Body</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="n">ioutil</span><span class="o">.</span><span class="n">ReadAll</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">Body</span><span class="p">)</span><span class="x">
	</span><span class="p">})</span><span class="x">
	
	</span><span class="c">// do many other things</span><span class="x">
	
	</span><span class="n">b</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">future</span><span class="p">()</span><span class="x">
	</span><span class="n">body</span><span class="p">,</span><span class="x"> </span><span class="n">_</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">b</span><span class="o">.</span><span class="p">([]</span><span class="kt">byte</span><span class="p">)</span><span class="x">
	
	</span><span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"response length: %d"</span><span class="p">,</span><span class="x"> </span><span class="nb">len</span><span class="p">(</span><span class="n">body</span><span class="p">))</span><span class="x">
	</span><span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"request error: %v"</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="p">)</span><span class="x">
</span><span class="p">}</span></code></pre></figure>

<p>Подсмотрел <a href="http://labs.strava.com/blog/futures-in-golang/">здесь</a></p>

<h3 id="впечателния">Впечателния</h3>

<p>Ощущения такие что нашел язык на котором надо программировать, а не
просто собирать что-то из кубиков. Oldschool ощущения подобные те
которые можно испытывать программируя на <strong>C</strong> при этом код не сильно
сложнее чем <strong>Nodejs</strong>.</p>

<p>Про производительсноть, - она очень высокая, особенно в сравнении
ruby, php и python, но хочется предостеречь от всяког рода
холиваров потомучто в итоге нужны нормальные полноценные бенчмарки, а
их как всегда нужно делать или как минимум проверять самому.</p>

<p>Вначале заметки я писал что взялся за реализацию MVC, да это довольно
просто, но начинает почти сразуже обрастать типовыми задачами, поэтому
имеет смысл взять готовый web-фреймворк которых на Go полно, а
особенно много мини-фреймворков котоырй реализуют <strong>routing</strong> и <strong>handlers</strong>
аналогично <strong>expressjs</strong>.</p>

<p>Напоследок вставлю
<a href="https://github.com/golang/go/wiki/Projects">список проектов написанных на Go</a>
в нем довольно много интересного например Docker. А это как минмум
значит что Docker это next big thing к которой стоит пресмотреться.</p>

<p>Это просто заметка, а не мануал, читайте документацию, во Go она отличная.</p>

<h3 id="ссылки">Ссылки</h3>

<p><a href="http://karlheinzniebuhr.github.io/en/2015/09/28/C-vs-Go-vs-pypy-vs-Python/">Бенчмарк Go и других</a></p>

<p><a href="https://www.toptal.com/go/go-programming-a-step-by-step-introductory-tutorial">Go introduction by Toptal</a></p>

<p><a href="https://github.com/avelino/awesome-go">Курируемый список библиотек и инструментов на Go</a></p>

<p><a href="https://gobyexample.com/">Много примеров типовых решений на Go</a></p>

<p><a href="http://golang-book.ru/">Русифицированная книга про Go</a></p>

<p><a href="http://www.golangpatterns.info/">Стандартные паттерны в Go</a></p>

<p><a href="http://golang-examples.tumblr.com">Много примеров на Go</a></p>

<p><a href="http://soryy.com/blog/2014/common-mistakes-with-go-lang/">Типовые ошибки в Go</a></p>

<p><a href="https://habrahabr.ru/post/195574/">Хороший пример про каналы и CPU</a></p>

<p><a href="http://wysocki.in/golang-channels-basics/">Пример каналов</a></p>

<p><a href="https://github.com/jinzhu/gorm">Gorm - Лучшая SQL ORM на Golang</a></p>

	</div>
	<section>
	    <h2>Comments</h2>
	    <div id="disqus_thread"></div>
	</section>
	<script type="text/javascript">
         /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
         var disqus_shortname = 'om6'; // required: replace example with your forum shortname

         /* * * DON'T EDIT BELOW THIS LINE * * */
         (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
         })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>    	
    </div>
</div>

	</div>
	<footer class="footer">
	    Dmitry Rodichev &copy; 2003 - 2019 <br>
	    Копирование и распрастранение страницы разрешено только в оригинальном не изменном виде, включая это сообщение..<br>
	    Verbatim copying and redistribution of this entire page are permitted provided this notice is preserved. <br>
	    Verbatim copying and redistribution of any of the photos in the photos subdirectory is permitted under the <a href="http://creativecommons.org/licenses/by-nd/3.0/" rel="nofollow"> Creative Commons Noderivs license version 3.0</a> or later.
	</footer>
	
	<script src="/blog/assets/vendor/jquery.min.js"></script>
	<script src="/blog/assets/vendor/popper.min.js"></script>
	<script src="/blog/assets/vendor/bootstrap.min.js"></script>
    </body>
</html>
